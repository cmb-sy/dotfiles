---
name: handover
description: 未完了の作業でセッションを終えるとき、別エージェントへタスクを渡すとき、または前のセッションから作業を再開するときに使う。トリガー例：「hand off」「resume」「続きから」「前回の続き」「ハンドオーバー」「セッション引き継ぎ」、コンテキストが逼迫しているのに作業が未完了、複数エージェントでのタスク委譲。
---

# ハンドオーバー

## 原則

**クリーンなセッション × 良いプロンプト > 長期化して誤りが積み重なったセッション**

コンテキストが増えるほど性能は劣化する。限界が来る前に状態を保存し、新セッションで再開する。

## 自律トリガー（自動実行条件）

以下のいずれかに該当したら、ユーザーの指示を待たずにハンドオーバーを開始する:

- コンテキスト圧縮の通知を受け取った
- ツール呼び出しが 50 回を超えた
- レスポンス遅延が顕著になった
- セッション継続が困難と判断した

## 送り出しプロトコル

1. **停止** — 新しいタスクを始めない
2. **状態確認** — `git status` / テスト実行 / 壊れた状態がないことを確認
3. **ハンドオーバー文書を作成** — [TEMPLATE.md](TEMPLATE.md) を使用
   - 保存先: `.claude/handovers/YYYY-MM-DD_HHmm.md`
   - 200行以内に収める。コードブロックは使わず「ファイルパス:行番号」で参照
4. **コミット** — 未コミットの状態は明示的に記載
5. **ユーザーに通知** — 保存パスを伝える

## 受け取りプロトコル

1. **最初にハンドオーバー文書を読む** — 何より先に
2. **状態を検証** — `git status` / テスト実行で現実と照合
3. **不一致を調査** — 乖離があれば作業前に解決
4. **次のステップを確認** — 優先順位が不明な場合はユーザーに確認
5. **このセッション終了時に更新** — 新しいタイムスタンプで作成

## 必須セクション

| セクション | 目的 |
|-----------|------|
| 完了した作業 | 何が終わったか |
| **却下した代替案** | **なぜその選択肢を捨てたか（最重要）** |
| 下した決定 | 採用した方針とその理由 |
| 障害・エラー | 遭遇した問題と対処 |
| 次のステップ | 優先順位付きの具体的な次の行動 |
| 影響ファイル | 変更したファイルの一覧 |

> **「却下した代替案」が最も重要**。次のエージェントが同じ袋小路を再探索するのを防ぐ。
> 積み重なったハンドオーバー文書はそのままプロジェクトの ADR（アーキテクチャ決定記録）になる。

## よくある失敗

| 失敗 | 修正 |
|------|------|
| 曖昧な次のステップ | ファイルパス・関数名・行番号まで記載 |
| 却下理由がない | 次のエージェントが同じ過ちを繰り返す |
| 状態検証をスキップ | ハンドオーバーが古い可能性がある |
| 200行超え | 詳細はコード・コミット・別ファイルに委ねる |
| 読む前に作業開始 | 必ずハンドオーバー文書を先に読む |
